# Instrument driver configuration file.

[General settings]

# The name is shown in all the configuration windows
name: SQE_Keysight_PNA_X_N5241B

# The version string should be updated whenever changes are made to this config file
version: 2.0

# Name of folder containing the code defining a custom driver. Do not define this item
# or leave it blank for any standard driver based on the built-in VISA interface.
driver_path: SQE_Keysight_PNA_X_N5241B

# default interface and address
interface: VISA
address: GPIB1::16::INSTR
term_char: CR+LF


[Model and options]
# The option section allow instruments with different options to use the same driver

# List of models supported by this driver
model_str_1: N5241B

# Check instrument model id at startup (True or False). Default is False
check_model: True

# Valid model strings returned by the instrument. Default value = model_str
model_id_1: N5241B



# General VISA settings for the instrument.
[VISA settings]

# Enable or disable communication over the VISA protocol (True or False)
# If False, the driver will not perform any operations (unless there is a custom driver).
use_visa = True

# Reset the interface (not the instrument) at startup (True or False).  Default is False
reset: True

# Time (in seconds) before the timing out while waiting for an instrument response. Default is 5
timeout: 10

# Query instrument errors (True or False).  If True, every command sent to the device will
# be followed by an error query.  This is useful when testing new setups, but may degrade
# performance by slowing down the instrument communication. 
query_instr_errors: False 

# Bit mask for checking status byte errors (default is 255, include all errors)
# The bits signal the following errors:
# 0: Operation
# 1: Request control
# 2: Query error
# 3: Device error
# 4: Execution error
# 5: Command error
# 6: User request
# 7: Power on
error_bit_mask: 255

# SCPI string to be used when querying for instrument error messages
error_cmd: 

# Initialization commands are sent to the instrument when starting the driver
# *RST will reset the device, *CLS clears the interface
init: :INIT:CONT ON;:FORM:BORD NORM;

# Boolean string values (used for sending True/False to instrument), default is 1 and 0
#str_true: ON
#str_false: OFF

# Final commands sent to the instrument when closing the driver
final: 


# Define quantities in sections. This list is a selection of allowed keywords,
# see the manual for a full list of options
#   datatype:      The datatype should be one of DOUBLE, BOOLEAN, COMBO,
#                  STRING, COMPLEX, VECTOR, VECTOR_COMPLEX, PATH or BUTTON.
#   unit:          Quantity unit
#   set_cmd:       Command used to send data to the instrument. Put <*> where the value should appear.
#   get_cmd:       Command used to get the data from the instrument. Default is set_cmd?
#   def_value:     Default value
#   low_lim:       Lowest allowable value.  Defaults to -INF
#   high_lim:      Highest allowable values.  Defaults to +INF
#   combo_def_1:   First option in a pull-down combo box. Only used when datatype=COMBO
#   combo_def_2:   Second option in a pull-down combo box. Only used when datatype=COMBO
#   ...
#   combo_def_n:   nth option in a pull-down combo box. Only used when datatype=COMBO
#   state_quant:   Quantity that determines this control's visibility
#   state_value_1: Value of "state_quant" for which the control is visible
#   state_value_2: Value of "state_quant" for which the control is visible
#   ...
#   state_value_n: Value of "state_quant" for which the control is visible
#   permission:    Sets read/writability, options are BOTH, READ, WRITE or NONE. Default is BOTH 
#   section:         Name of the group where the control belongs.
#   section:       Name of the section where the control belongs.


[S11 - Enabled]
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[S21 - Enabled]
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[S12 - Enabled]
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[S22 - Enabled]
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[a2/b2_1 - Enabled]
label: Forward switch-term - Enabled
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[a1/b1_2 - Enabled]
label: Reverse switch-term - Enabled
datatype: BOOLEAN
def_value: False
section: Response
group: Signals

[A_2 - Enabled]
label: Receiver A IN - Enabled
datatype: BOOLEAN
def_value: False
section: Response
group: Signals
tooltip: Power on receiver A when power is output by port 2

[B_1 - Enabled]
label: Receiver B IN - Enabled
datatype: BOOLEAN
def_value: False
section: Response
group: Signals
tooltip: Power on receiver B when power is output by port 1

[Autoscale All]
datatype: BUTTON
set_cmd: DISP:WIND:Y:AUTO
section: Response
group: Signals

[S11]
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[S21]
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[S12]
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[S22]
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[a2/b2_1]
label: Forward switch-term
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[a1/b1_2]
label: Reverse switch-term
x_name: Frequency
x_unit: Hz
datatype: VECTOR_COMPLEX
permission: READ
section: Response
group: Signals

[A_2]
label: Receiver A IN
x_name: Frequency
x_unit: Hz
unit: dBm
datatype: VECTOR
permission: READ
section: Response
group: Signals
tooltip: Power on receiver A when power is output by port 2

[B_1]
label: Receiver B IN
x_name: Frequency
x_unit: Hz
unit: dBm
datatype: VECTOR
permission: READ
section: Response
group: Signals
tooltip: Power on receiver B when power is output by port 1

[S11 - Value]
datatype: COMPLEX
unit: Hz
permission: READ
section: Response
group: Signals

[S21 - Value]
datatype: COMPLEX
unit: Hz
permission: READ
section: Response
group: Signals

[S12 - Value]
datatype: COMPLEX
unit: Hz
permission: READ
section: Response
group: Signals

[S22 - Value]
datatype: COMPLEX
unit: Hz
permission: READ
section: Response
group: Signals

[IF bandwidth]
datatype: DOUBLE
def_value: 1E3
unit: Hz
set_cmd: :SENS:BWID
section: Response
group: AVG BW

[Average]
datatype: BOOLEAN
def_value: False
set_cmd: :SENS:AVER
section: Response
group: AVG BW

[# of averages]
datatype: DOUBLE
def_value: 10
low_lim: 1
high_lim: 65536
set_cmd: :SENS:AVER:COUN
section: Response
group: AVG BW

[Wait for new trace]
datatype: BOOLEAN
def_value: False
section: Response
group: AVG BW

#####################
# PRIMARY FREQUENCY #
#####################

[Range type]
datatype: COMBO
def_value: Start - Stop
combo_def_1: Center - Span
combo_def_2: Start - Stop
combo_def_3: Single frequency
permission: WRITE
section: Frequency
group: Primary frequency

[Start frequency]
datatype: DOUBLE
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
get_cmd: :SENS:FREQ:STAR?
state_quant: Range type
state_value_1: Start - Stop
section: Frequency
group: Primary frequency

[Stop frequency]
datatype: DOUBLE
def_value: 12E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
get_cmd: :SENS:FREQ:STOP?
state_quant: Range type
state_value_1: Start - Stop
section: Frequency
group: Primary frequency

[Center frequency]
datatype: DOUBLE
def_value: 8E9
unit: Hz
low_lim: 10E6
high_lim: 13.5E9
get_cmd: :SENS:FREQ:CENT?
state_quant: Range type
state_value_1: Center - Span
state_value_2: Single frequency
section: Frequency
group: Primary frequency

[Span]
datatype: DOUBLE
def_value: 8E9
low_lim: 0
high_lim: 13.49E9
unit: Hz
get_cmd: :SENS:FREQ:SPAN?
state_quant: Range type
state_value_1: Center - Span
section: Frequency
group: Primary frequency

[# of points]
datatype: DOUBLE
tooltip: Enter an integer
def_value: 201
low_lim: 1
high_lim: 100003
set_cmd: :SENS:SWE:POIN
state_quant: Range type
state_value_1: Center - Span
state_value_2: Start - Stop
section: Frequency
group: Primary frequency

[Sweep type]
datatype: COMBO
combo_def_1: Linear
combo_def_2: Log
combo_def_3: Lorentzian
def_value: Linear
section: Frequency
group: Primary frequency

[Q Value]
datatype: DOUBLE
def_value: 1.0
section: Frequency
state_quant: Sweep type
state_value_1: Lorentzian
group: Primary frequency

[Maximum Angle]
datatype: DOUBLE
unit: rad
def_value: 0.0
section: Frequency
state_quant: Sweep type
state_value_1: Lorentzian
group: Primary frequency

[Sweep mode]
datatype: COMBO
def_value: Stepped
combo_def_1: Stepped
combo_def_2: Analog
cmd_def_1: STEP
cmd_def_2: ANAL
set_cmd: :SENS:SWE:GEN
section: Frequency
group: Primary frequency

[Enable Frequency Offset]
datatype: BOOLEAN
set_cmd: SENS:FOM:STAT
def_value: False
section: Frequency
group: Frequency offset

[X-axis display range]
datatype: COMBO
tooltip: Select the range to be displayed on the VNA x-axis
state_quant: Enable Frequency Offset
def_value: Primary
combo_def_1: Primary
combo_def_2: Source
combo_def_3: Receivers
combo_def_4: Source2
state_value_1: True
set_cmd: :SENS:FOM:DISP:SEL
cmd_def_1: "Primary"
cmd_def_2: "Source"
cmd_def_3: "Receivers"
cmd_def_4: "Source2"
section: Frequency
group: Frequency offset

[X-axis values]
datatype: VECTOR
unit: Hz
permission: READ
section: Frequency
group: Primary frequency


####################
# SOURCE FREQUENCY # Number 2
####################

[Source range Mode]
datatype: COMBO
label: Mode
state_quant: Enable Frequency Offset
state_value_1: True
def_value: Coupled
combo_def_1: Coupled
combo_def_2: Un-Coupled
section: Frequency
group: Source frequency

[Source range Offset]
datatype: DOUBLE
label: Offset
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
state_quant: Source range Mode
state_value_1: Coupled
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Source frequency

[Source range Multiplier]
datatype: DOUBLE
label: Multiplier
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
state_quant: Source range Mode
state_value_1: Coupled
def_value: 1
low_lim: -1000
high_lim: 1000
section: Frequency
group: Source frequency

[Source range Divisor]
label: Divisor
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Source range Mode
state_value_1: Coupled
def_value: 1
low_lim: 1
high_lim: 1000
section: Frequency
group: Source frequency

[Source range Sweep type]
label: Sweep type
datatype: COMBO
state_quant: Source range Mode
state_value_1: Un-Coupled
def_value: Linear
combo_def_1: Linear
combo_def_2: Log
combo_def_3: Lorentzian
section: Frequency
group: Source frequency

[Source range Range type]
label: Range type
datatype: COMBO
combo_def_1: Start - Stop
combo_def_2: Center - Span
def_value: Start - Stop
state_quant: Source range Mode
state_value_1: Un-Coupled
section: Frequency
group: Source frequency

[Source range Start frequency]
label: Start frequency
datatype: DOUBLE
state_quant: Source range Mode
state_value_1: Un-Coupled
second_state_quant: Source range Range type
second_state_value_1: Start - Stop
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source frequency

[Source range Stop frequency]
label: Stop frequency
datatype: DOUBLE
state_quant: Source range Mode
state_value_1: Un-Coupled
second_state_quant: Source range Range type
second_state_value_1: Start - Stop
def_value: 12E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source frequency

[Source range Center]
label: Center
datatype: DOUBLE
state_quant: Source range Mode
state_value_1: Un-Coupled
second_state_quant: Source range Range type
second_state_value_1: Center - Span
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source frequency

[Source range Span]
label: Span
datatype: DOUBLE
state_quant: Source range Mode
state_value_1: Un-Coupled
second_state_quant: Source range Range type
second_state_value_1: Center - Span
def_value: 1E9
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Source frequency

[Source range Q Value]
label: Q Value
datatype: DOUBLE
def_value: 1.0
state_quant: Source range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Source frequency

[Source range Maximum Angle]
label: Maximum Angle
datatype: DOUBLE
unit: rad
def_value: 0.0
state_quant: Source range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Source frequency

######################
# RECEIVER FREQUENCY #
######################

[Receivers range Mode]
label: Mode
datatype: COMBO
state_quant: Enable Frequency Offset
state_value_1: True
def_value: Coupled
combo_def_1: Coupled
combo_def_2: Un-Coupled
section: Frequency
group: Receiver frequency

[Receivers range Offset]
label: Offset
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Coupled
def_value: 0
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Receiver frequency

[Receivers range Multiplier]
label: Multiplier
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Coupled
def_value: 1
low_lim: -1000
high_lim: 1000
section: Frequency
group: Receiver frequency

[Receivers range Divisor]
label: Divisor
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Coupled
def_value: 1
low_lim: 1
high_lim: 1000
section: Frequency
group: Receiver frequency

[Receivers range Sweep type]
label: Sweep type
datatype: COMBO
state_quant: Receivers range Mode
state_value_1: Un-Coupled
def_value: Linear
combo_def_1: Linear
combo_def_2: Log
combo_def_3: Lorentzian
section: Frequency
group: Receiver frequency

[Receivers range Range type]
label: Range type
datatype: COMBO
combo_def_1: Start - Stop
combo_def_2: Center - Span
def_value: Start - Stop
state_quant: Receivers range Mode
state_value_1: Un-Coupled
section: Frequency
group: Receiver frequency

[Receivers range Start frequency]
label: Start frequency
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Un-Coupled
second_state_quant: Receivers range Range type
second_state_value_1: Start - Stop
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Receiver frequency

[Receivers range Stop frequency]
label: Stop frequency
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Un-Coupled
second_state_quant: Receivers range Range type
second_state_value_1: Start - Stop
def_value: 12E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Receiver frequency

[Receivers range Center]
label: Center
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Un-Coupled
second_state_quant: Receivers range Range type
second_state_value_1: Center - Span
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Receiver frequency

[Receivers range Span]
label: Span
datatype: DOUBLE
state_quant: Receivers range Mode
state_value_1: Un-Coupled
second_state_quant: Receivers range Range type
second_state_value_1: Center - Span
def_value: 1E9
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Receiver frequency

[Receivers range Q Value]
label: Q Value
datatype: DOUBLE
def_value: 1.0
state_quant: Receivers range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Receiver frequency

[Receivers range Maximum Angle]
label: Maximum Angle
datatype: DOUBLE
unit: rad
def_value: 0.0
state_quant: Receivers range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Receiver frequency

#####################
# SOURCE2 FREQUENCY #
#####################

[Source2 range Mode]
label: Mode
datatype: COMBO
state_quant: Enable Frequency Offset
state_value_1: True
def_value: Coupled
combo_def_1: Coupled
combo_def_2: Un-Coupled
section: Frequency
group: Source2 frequency

[Source2 range Offset]
label: Offset
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Coupled
def_value: 0
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Source2 frequency

[Source2 range Multiplier]
label: Multiplier
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Coupled
def_value: 1
low_lim: -1000
high_lim: 1000
section: Frequency
group: Source2 frequency

[Source2 range Divisor]
label: Divisor
tooltip: Frequency range = [Primary range x (Multiplier / Divisor)] + Offset
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Coupled
def_value: 1
low_lim: 1
high_lim: 1000
section: Frequency
group: Source2 frequency

[Source2 range Sweep type]
label: Sweep type
datatype: COMBO
state_quant: Source2 range Mode
state_value_1: Un-Coupled
def_value: Linear
combo_def_1: Linear
combo_def_2: Log
combo_def_3: Lorentzian
section: Frequency
group: Source2 frequency

[Source2 range Range type]
label: Range type
datatype: COMBO
combo_def_1: Start - Stop
combo_def_2: Center - Span
def_value: Start - Stop
state_quant: Source2 range Mode
state_value_1: Un-Coupled
section: Frequency
group: Source2 frequency

[Source2 range Start frequency]
label: Start frequency
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Un-Coupled
second_state_quant: Source2 range Range type
second_state_value_1: Start - Stop
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source2 frequency

[Source2 range Stop frequency]
label: Stop frequency
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Un-Coupled
second_state_quant: Source2 range Range type
second_state_value_1: Start - Stop
def_value: 12E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source2 frequency

[Source2 range Center]
label: Center
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Un-Coupled
second_state_quant: Source2 range Range type
second_state_value_1: Center - Span
def_value: 4E9
low_lim: 10E6
high_lim: 13.5E9
unit: Hz
section: Frequency
group: Source2 frequency

[Source2 range Span]
label: Span
datatype: DOUBLE
state_quant: Source2 range Mode
state_value_1: Un-Coupled
second_state_quant: Source2 range Range type
second_state_value_1: Center - Span
def_value: 1E9
low_lim: -13.49E9
high_lim: 13.49E9
unit: Hz
section: Frequency
group: Source2 frequency

[Source2 range Q Value]
label: Q Value
datatype: DOUBLE
def_value: 1.0
state_quant: Source2 range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Source2 frequency

[Source2 range Maximum Angle]
label: Maximum Angle
datatype: DOUBLE
unit: rad
def_value: 0.0
state_quant: Source2 range Sweep type
state_value_1: Lorentzian
section: Frequency
group: Source2 frequency

#########
# POWER #
#########

[Power ON (All Channels)]
datatype: BOOLEAN
def_value: False
set_cmd: :OUTP
section: Power
group: General power settings

[Couple port powers]
datatype: BOOLEAN
def_value: False
get_cmd: SOUR:POW:COUP?
section: Power
group: General power settings

[Autorange source attenuation]
tooltip: Make the instrument chose the right attenuator to output the desired power level
datatype: BOOLEAN
def_value: True
state_quant: Couple port powers
state_value_1: True
set_cmd: SOUR:POW:ATT:AUTO
section: Power
group: General power settings

[Source attenuation]
datatype: COMBO
unit: dB
def_value: 20
state_quant: Couple port powers
state_value_1: True
second_state_quant: Autorange source attenuation
second_state_value_1: False
set_cmd: SOUR:POW:ATT
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
combo_def_9: 40
combo_def_10: 45
combo_def_11: 50
combo_def_12: 55
combo_def_13: 60
combo_def_14: 65
section: Power
group: General power settings

[Use power slope]
datatype: BOOLEAN
def_value: False
set_cmd: SOUR:POW:SLOP:STAT
section: Power
group: General power settings

[Power slope]
tooltip: The port output power increases/decreases at the specified rate (starting from 0 Hz!) to compensate compensate for cables etc...
datatype: DOUBLE
unit: dB/GHz
low_lim: -2
high_lim: 2
set_cmd: SOUR:POW:SLOP
def_value: 0
section: Power
group: General power settings

[Output power]
tooltip: The power entering the cables at the output ports
datatype: DOUBLE
def_value: -30.0
unit: dBm
low_lim: -95
high_lim: 30
state_quant: Couple port powers
state_value_1: True
get_cmd: :SOUR:POW?
section: Power
group: General power settings

##########
# PORT 1 #
##########

[Source state on Port 1]
label: Source state at port
tooltip: AUTO = power is turned on when required for a mesaurement, ON/OFF = power is always on/off
datatype: COMBO
combo_def_1: AUTO
combo_def_2: ON
combo_def_3: OFF
cmd_def_1: AUTO
cmd_def_2: ON
cmd_def_3: OFF
set_cmd: SOUR:POW:MODE <*>, "Port 1"
get_cmd: SOUR:POW:MODE? "Port 1"
section: Power
group: Port 1

[Source power on Port 1]
label: Source port
datatype: DOUBLE
tooltip: The actual power output by the instrument
unit: dBm
def_value: -30
low_lim: -95
high_lim: 30
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 1

[Power offset on Port 1]
label: Power offset
tooltip: Gain or attenuation along the line before the DUT. Used to adjust the source power to achieve the desired power level at the DUT
datatype: DOUBLE
def_value: 0
unit: dB
get_cmd: :SOUR:POW:CORR:OFFS:MAGN? "Port 1"
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 1

[Port power on Port 1]
label: Port power (at DUT level)
tooltip: This is the power level that Port 1 has to achieve at the DUT level, keeping into account the power offset
datatype: DOUBLE
def_value: -30
unit: dBm
state_quant: Couple port powers
state_value_1: FalsE
get_cmd: :SOUR:POW:LEV:IMM:AMPL? "Port 1"
section: Power
group: Port 1

[Enable power limit on Port 1]
label: Enable power limit
datatype: BOOLEAN
def_value: False
#set_cmd: SYST:POW:LIM:STAT no scpi with "Port num" notation
section: Power
group: Port 1

[Power limit on Port 1]
label: Power limit
tooltip: Limits the source power to achieve a maximum value: Power limit > Port power = Source power - Offset
datatype: DOUBLE
unit: dBm
def_value: 100
low_lim: -95
high_lim: 100
section: Power
group: Port 1
# no scpi with "Port num" notation

[Autorange source attenuation on Port 1]
label: Autorange source attenuation
tooltip: Make the instrument chose the right attenuator to output the desired power level
datatype: BOOLEAN
def_value: True
state_quant: Couple port powers
state_value_1: False
get_cmd: SOUR:POW:ATT:AUTO? "Port 1"
section: Power
group: Port 1

[Source attenuation on Port 1]
label: Source attenuation
datatype: COMBO
unit: dB
def_value: 20
state_quant: Couple port powers
state_value_1: False
second_state_quant: Autorange source attenuation on Port 1
second_state_value_1: False
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
combo_def_9: 40
combo_def_10: 45
combo_def_11: 50
combo_def_12: 55
combo_def_13: 60
combo_def_14: 65
section: Power
group: Port 1

##########
# PORT 2 #
##########

[Source state on Port 2]
label: Source state at port
tooltip: AUTO = power is turned on when required for a mesaurement, ON/OFF = power is always on/off
datatype: COMBO
combo_def_1: AUTO
combo_def_2: ON
combo_def_3: OFF
cmd_def_1: AUTO
cmd_def_2: ON
cmd_def_3: OFF
set_cmd: SOUR:POW:MODE <*>, "Port 2"
get_cmd: SOUR:POW:MODE? "Port 2"
section: Power
group: Port 2

[Source power on Port 2]
label: Source port
datatype: DOUBLE
tooltip: The actual power output by the instrument
unit: dBm
def_value: -30
low_lim: -95
high_lim: 30
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 2

[Power offset on Port 2]
label: Power offset
tooltip: Gain or attenuation along the line before the DUT. Used to adjust the source power to achieve the desired power level at the DUT
datatype: DOUBLE
def_value: 0
unit: dB
get_cmd: :SOUR:POW:CORR:OFFS:MAGN? "Port 2"
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 2

[Port power on Port 2]
label: Port power (at DUT level)
tooltip: This is the power level that Port 2 has to achieve at the DUT level, keeping into account the power offset
datatype: DOUBLE
def_value: -30
unit: dBm
state_quant: Couple port powers
state_value_1: FalsE
get_cmd: :SOUR:POW:LEV:IMM:AMPL? "Port 2"
section: Power
group: Port 2

[Enable power limit on Port 2]
label: Enable power limit
datatype: BOOLEAN
def_value: False
#set_cmd: SYST:POW:LIM:STAT no scpi with "Port num" notation
section: Power
group: Port 2

[Power limit on Port 2]
label: Power limit
tooltip: Limits the source power to achieve a maximum value: Power limit > Port power = Source power - Offset
datatype: DOUBLE
unit: dBm
def_value: 100
low_lim: -95
high_lim: 100
section: Power
group: Port 2
# no scpi with "Port num" notation

[Autorange source attenuation on Port 2]
label: Autorange source attenuation
tooltip: Make the instrument chose the right attenuator to output the desired power level
datatype: BOOLEAN
def_value: True
state_quant: Couple port powers
state_value_1: False
get_cmd: SOUR:POW:ATT:AUTO? "Port 2"
section: Power
group: Port 2

[Source attenuation on Port 2]
label: Source attenuation
datatype: COMBO
unit: dB
def_value: 20
state_quant: Couple port powers
state_value_1: False
second_state_quant: Autorange source attenuation on Port 2
second_state_value_1: False
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
combo_def_9: 40
combo_def_10: 45
combo_def_11: 50
combo_def_12: 55
combo_def_13: 60
combo_def_14: 65
section: Power
group: Port 2

##########
# PORT 3 #
##########

[Source state on Port 3]
label: Source state at port
tooltip: AUTO = power is turned on when required for a mesaurement, ON/OFF = power is always on/off
datatype: COMBO
combo_def_1: AUTO
combo_def_2: ON
combo_def_3: OFF
cmd_def_1: AUTO
cmd_def_2: ON
cmd_def_3: OFF
set_cmd: SOUR:POW:MODE <*>, "Port 3"
get_cmd: SOUR:POW:MODE? "Port 3"
section: Power
group: Port 3

[Source power on Port 3]
label: Source port
datatype: DOUBLE
tooltip: The actual power output by the instrument
unit: dBm
def_value: -30
low_lim: -95
high_lim: 30
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 3

[Power offset on Port 3]
label: Power offset
tooltip: Gain or attenuation along the line before the DUT. Used to adjust the source power to achieve the desired power level at the DUT
datatype: DOUBLE
def_value: 0
unit: dB
get_cmd: :SOUR:POW:CORR:OFFS:MAGN? "Port 3"
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 3

[Port power on Port 3]
label: Port power (at DUT level)
tooltip: This is the power level that Port 3 has to achieve at the DUT level, keeping into account the power offset
datatype: DOUBLE
def_value: -30
unit: dBm
state_quant: Couple port powers
state_value_1: FalsE
get_cmd: :SOUR:POW:LEV:IMM:AMPL? "Port 3"
section: Power
group: Port 3

[Enable power limit on Port 3]
label: Enable power limit
datatype: BOOLEAN
def_value: False
#set_cmd: SYST:POW:LIM:STAT no scpi with "Port num" notation
section: Power
group: Port 3

[Power limit on Port 3]
label: Power limit
tooltip: Limits the source power to achieve a maximum value: Power limit > Port power = Source power - Offset
datatype: DOUBLE
unit: dBm
def_value: 100
low_lim: -95
high_lim: 100
section: Power
group: Port 3
# no scpi with "Port num" notation

[Autorange source attenuation on Port 3]
label: Autorange source attenuation
tooltip: Make the instrument chose the right attenuator to output the desired power level
datatype: BOOLEAN
def_value: True
state_quant: Couple port powers
state_value_1: False
get_cmd: SOUR:POW:ATT:AUTO? "Port 3"
section: Power
group: Port 3

[Source attenuation on Port 3]
label: Source attenuation
datatype: COMBO
unit: dB
def_value: 20
state_quant: Couple port powers
state_value_1: False
second_state_quant: Autorange source attenuation on Port 3
second_state_value_1: False
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
combo_def_9: 40
combo_def_10: 45
combo_def_11: 50
combo_def_12: 55
combo_def_13: 60
combo_def_14: 65
section: Power
group: Port 3

##########
# PORT 2 #
##########

[Source state on Port 4]
label: Source state at port
tooltip: AUTO = power is turned on when required for a mesaurement, ON/OFF = power is always on/off
datatype: COMBO
combo_def_1: AUTO
combo_def_2: ON
combo_def_3: OFF
cmd_def_1: AUTO
cmd_def_2: ON
cmd_def_3: OFF
set_cmd: SOUR:POW:MODE <*>, "Port 4"
get_cmd: SOUR:POW:MODE? "Port 4"
section: Power
group: Port 4

[Source power on Port 4]
label: Source port
datatype: DOUBLE
tooltip: The actual power output by the instrument
unit: dBm
def_value: -30
low_lim: -95
high_lim: 30
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 4

[Power offset on Port 4]
label: Power offset
tooltip: Gain or attenuation along the line before the DUT. Used to adjust the source power to achieve the desired power level at the DUT
datatype: DOUBLE
def_value: 0
unit: dB
get_cmd: :SOUR:POW:CORR:OFFS:MAGN? "Port 4"
state_quant: Couple port powers
state_value_1: False
section: Power
group: Port 4

[Port power on Port 4]
label: Port power (at DUT level)
tooltip: This is the power level that Port 4 has to achieve at the DUT level, keeping into account the power offset
datatype: DOUBLE
def_value: -30
unit: dBm
state_quant: Couple port powers
state_value_1: FalsE
get_cmd: :SOUR:POW:LEV:IMM:AMPL? "Port 4"
section: Power
group: Port 4

[Enable power limit on Port 4]
label: Enable power limit
datatype: BOOLEAN
def_value: False
#set_cmd: SYST:POW:LIM:STAT no scpi with "Port num" notation
section: Power
group: Port 4

[Power limit on Port 4]
label: Power limit
tooltip: Limits the source power to achieve a maximum value: Power limit > Port power = Source power - Offset
datatype: DOUBLE
unit: dBm
def_value: 100
low_lim: -95
high_lim: 100
section: Power
group: Port 4
# no scpi with "Port num" notation

[Autorange source attenuation on Port 4]
label: Autorange source attenuation
tooltip: Make the instrument chose the right attenuator to output the desired power level
datatype: BOOLEAN
def_value: True
state_quant: Couple port powers
state_value_1: False
get_cmd: SOUR:POW:ATT:AUTO? "Port 4"
section: Power
group: Port 4

[Source attenuation on Port 4]
label: Source attenuation
datatype: COMBO
unit: dB
def_value: 20
state_quant: Couple port powers
state_value_1: False
second_state_quant: Autorange source attenuation on Port 4
second_state_value_1: False
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
combo_def_9: 40
combo_def_10: 45
combo_def_11: 50
combo_def_12: 55
combo_def_13: 60
combo_def_14: 65
section: Power
group: Port 4

#############
# RECEIVERS #
#############

[Attenuation on receiver A]
datatype: COMBO
unit: dB
def_value: 0
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
set_cmd: SENS:POW:ATT AREC, <*>
cmd_def_1: 0
cmd_def_2: 5
cmd_def_3: 10
cmd_def_4: 15
cmd_def_5: 20
cmd_def_6: 25
cmd_def_7: 30
cmd_def_8: 35
section: Receivers
group: Attenuators on receivers

[Attenuation on receiver B]
datatype: COMBO
unit: dB
def_value: 0
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
set_cmd: SENS:POW:ATT BREC, <*>
cmd_def_1: 0
cmd_def_2: 5
cmd_def_3: 10
cmd_def_4: 15
cmd_def_5: 20
cmd_def_6: 25
cmd_def_7: 30
cmd_def_8: 35
section: Receivers
group: Attenuators on receivers

[Attenuation on receiver C]
datatype: COMBO
unit: dB
def_value: 0
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
set_cmd: SENS:POW:ATT CREC, <*>
cmd_def_1: 0
cmd_def_2: 5
cmd_def_3: 10
cmd_def_4: 15
cmd_def_5: 20
cmd_def_6: 25
cmd_def_7: 30
cmd_def_8: 35
section: Receivers
group: Attenuators on receivers

[Attenuation on receiver D]
datatype: COMBO
unit: dB
def_value: 0
combo_def_1: 0
combo_def_2: 5
combo_def_3: 10
combo_def_4: 15
combo_def_5: 20
combo_def_6: 25
combo_def_7: 30
combo_def_8: 35
set_cmd: SENS:POW:ATT DREC, <*>
cmd_def_1: 0
cmd_def_2: 5
cmd_def_3: 10
cmd_def_4: 15
cmd_def_5: 20
cmd_def_6: 25
cmd_def_7: 30
cmd_def_8: 35
section: Receivers
group: Attenuators on receivers

###############
# CALIBRATION #
###############

# [Use calibration]
# datatype: BOOLEAN
# def_value: False
# group: General settings
# section: Calibration

# [Calibration method]
# datatype: COMBO
# def_value: SOLR
# combo_def_1: SOLR
# combo_def_2: TRL
# combo_def_3: SOLT
# group: General settings
# section: Calibration

# [Select an action]
# datatype: COMBO
# def_value: Load previous measurement
# combo_def_2: Load previous measurement
# combo_def_1: Measure new standards
# group: General settings
# section: Calibration

# [Database for the SNP files]
# datatype: PATH
# group: General settings
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\SOLR_Cal_Kit SMA 1
# tooltip: The global folder where all the standards' acquistions will be stored
# section: Calibration

# # Measure new standards

# [Use today's date as sub-folder name]
# datatype: BOOLEAN
# group: General settings
# state_quant: Select an action
# state_value_1: Measure new standards
# def_value: True
# tooltip: The sub-folder for each acquistion will be today's date and current time in the format YYYY_MM_DD__HH_MM_SS
# section: Calibration

# [Sub-folder name]
# datatype: STRING
# group: General settings
# def_value: DefaultName
# state_quant: Use today's date as sub-folder name
# state_value_1: False
# second_state_quant: Select an action
# second_state_value_1: Measure new standards
# section: Calibration

# [VISA address of the QSwitchBox]
# datatype: STRING
# def_value: ASRL4::INSTR
# group: QSwitchBox
# section: Calibration
# state_quant: Select an action
# state_value_1: Measure new standards

# [Position of short standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: 5
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of open standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: 1
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of load standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: 6
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of reciprocal standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: SOLR
# def_value: 2
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of thru standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: SOLT
# state_value_2: TRL
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of reflect standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: TRL
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Position of line standard]
# datatype: COMBO
# combo_def_1: 1
# combo_def_2: 2
# combo_def_3: 3
# combo_def_4: 4
# combo_def_5: 5
# combo_def_6: 6
# group: QSwitchBox
# state_quant: Calibration method
# state_value_1: TRL
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Measure new standards

# [Awareness]
# label: I am aware that clicking the button RUN will activate the switches in the mixing chamber
# datatype: BOOLEAN
# state_quant: Select an action
# state_value_1: Measure new standards
# group: Standards' measurement
# def_value: False

# [RUN]
# tooltip: This button activates the switches and makes the VNA measure the standards
# datatype: BUTTON
# state_quant: Select an action
# state_value_1: Measure new standards
# group: Standards' measurement

# # Load previous measurement


# [Ideal short]
# datatype: PATH
# group: Ideal standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Short.s2p
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement


# [Ideal open]
# datatype: PATH
# group: Ideal standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Open.s2p
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Ideal load]
# datatype: PATH
# group: Ideal standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Load.s2p
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Ideal reciprocal]
# datatype: PATH
# group: Ideal standards
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Thru.s2p
# state_quant: Calibration method
# state_value_1: SOLR
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Ideal thru]
# datatype: PATH
# group: Ideal standards
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Thru.s2p
# state_quant: Calibration method
# state_value_1: SOLT
# state_value_2: TRL
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Ideal reflect]
# datatype: PATH
# group: Ideal standards
# state_quant: Calibration method
# state_value_1: TRL
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Reflect.s2p
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Ideal line]
# datatype: PATH
# group: Ideal standards
# state_quant: Calibration method
# state_value_1: TRL
# def_value: I:\Drive condivisi\SuperQuElectronics\Measurements\CryoRF_SPar_Calibration Standards\Ideals\Line.s2p
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Select an action
# second_state_value_1: Load previous measurement

# [Use the most recent standards' measurement in the database]
# tooltip: The database will be scanned to find the most recent folder named in the format YYYY_MM_DD__HH_MM_SS
# datatype: BOOLEAN
# def_value: true
# section: Calibration
# group: Measured standards
# state_quant: Select an action
# state_value_1: Load previous measurement

# [Measured short]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured open]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured load]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: SOLR
# state_value_2: SOLT
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured reciprocal]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: SOLR
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured thru]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: SOLT
# state_value_2: TRL
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured reflect]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: TRL
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Measured line]
# datatype: PATH
# group: Measured standards
# state_quant: Calibration method
# state_value_1: TRL
# tooltip: Select s2p file
# section: Calibration
# second_state_quant: Use the most recent standards' measurement in the database
# second_state_value_1: False

# [Import fixtures]
# tooltip: Import s2p
# datatype: BOOLEAN
# group: Fixture removal
# def_value: False
# state_quant: Calibration method
# state_value_1: TRL
# state_value_2: SOLT
# section: Calibration

# [Fixture on port 1]
# datatype: PATH
# tooltip: Select s2p file
# state_quant: Import fixtures
# state_value_1: True
# group: Fixture removal
# second_state_quant: Calibration method
# second_state_value_1: TRL
# second_state_value_2: SOLT
# section: Calibration

# [Fixture on port 2]
# datatype: PATH
# tooltip: Select s2p file
# state_quant: Import fixtures
# state_value_1: True
# group: Fixture removal
# second_state_quant: Calibration method
# second_state_value_1: TRL
# second_state_value_2: SOLT
# section: Calibration

# [Compute fixtures from the corrected reciprocal standard]
# datatype: BOOLEAN
# group: Fixture removal
# def_value: False
# state_quant: Import fixtures
# state_value_1: False
# second_state_quant: Calibration method
# second_state_value_1: SOLR
# tooltip: WARNING: This method is a rough approximation based just on the length of the cables, while other contributions (connectors, windings, etc) are neglected
# section: Calibration

# [Length of fixture on port 1]
# unit: Length of reciprocal standard
# datatype: DOUBLE
# low_lim: 0
# high_lim: 1
# def_value: 0.5
# group: Fixture removal
# state_quant: Compute fixtures from the corrected reciprocal standard
# state_value_1: True
# section: Calibration

# [Length of fixture on port 2]
# unit: Length of reciprocal standard
# datatype: DOUBLE
# low_lim: 0
# high_lim: 1
# def_value: 0.5
# group: Fixture removal
# state_quant: Compute fixtures from the corrected reciprocal standard
# state_value_1: True
# section: Calibration





